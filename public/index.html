<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8"/>
    <title>Document</title>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/paper.js/0.11.5/paper-full.min.js"></script>
	<script type="text/paperscript" canvas="graphCanvas">
	 var GraphPath;
	 var Start;
	 var End;

	 function onMouseDown(event) {
	   Start = event.point;
	   GraphPath = new Path();
	   GraphPath.strokeColor = 'black';
	   GraphPath.add(Start);
	   newNode(Start)
	 }

	 function onMouseUp(event) {
	   End = event.point;
	   GraphPath.add(End);
	   var vec = End - Start
	   var arrowTopBasePoint = (End - vec.normalize(12));
	   var arrowTop = newArrowTop(arrowTopBasePoint);
	   newNode(End)
	 }

	 function newNode(point) {
	   return new Path.Circle({
		 center: point,
		 radius: 5,
		 fillColor: '#009dec'
	   })
	 }

	 function newArrowTop(point) {
	   var path = new Path({
		 segments: [point + [0, -3], point + [0, 3], point + [10, 0]],
		 fillColor: 'black',
		 closed: true
	   });
	   path.rotate(getRotateAngleForArrowTop(Start, End), point);
	   return path;
	 }

	 function getRotateAngleForArrowTop(start, end) {
	   return (end - start).angle;
	 }
	</script>
  </head>
  <body>
	<canvas id="graphCanvas" style="width: 100%;height: 100%;min-width: 500px;min-height: 500px;"></canvas>
  </body>
</html>
